-- provided
select st_area(ST_GEOGFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))')) as area;

-- expected
SELECT ST_Area_Spheroid(ST_GEOMFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))')) AS area;

-- result
"area"
"12308778361.469452"


-- provided
select ST_DISTANCE(ST_GEOGFROMTEXT('POINT(2.3058359 48.858904)'),ST_GEOGFROMTEXT('POINT(11.4594367 48.1549958)'), true) / 1000 as km

-- expected
SELECT IF(TRUE
,ST_DISTANCE_SPHEROID(
    ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POINT(2.3058359 48.858904)'))
    ,ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POINT(11.4594367 48.1549958)')))
,ST_DISTANCE_SPHERE(
    ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POINT(2.3058359 48.858904)'))
    ,ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POINT(11.4594367 48.1549958)')))
)/1000 AS KM;

-- results
"km"
"680.463998149"

-- provided
select ST_DISTANCE(ST_GEOGFROMTEXT('POINT(2.3058359 48.858904)'),ST_GEOGFROMTEXT('POINT(11.4594367 48.1549958)')) / 1000 as km

-- expected
SELECT ST_DISTANCE_SPHERE(
    ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POINT(2.3058359 48.858904)'))
    ,ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POINT(11.4594367 48.1549958)'))
)/1000 AS KM;

-- results
"km"
"678.451551489"


-- provided
SELECT st_length(st_geogfromtext("LINESTRING(0 0, 0 1, 1 1, 1 0, 0 0)")) as geo;

-- expected
SELECT /* APPROXIMATION: ST_LENGTH SPHERE */ st_length_spheroid(st_flipcoordinates(st_geomfromtext('LINESTRING(0 0, 0 1, 1 1, 1 0, 0 0)'))) as geo;

-- results
"geo"
"443770.917248302"


-- provided
SELECT st_maxdistance(st_geogfromtext('LINESTRING(0 0, 0 1, 1 1, 1 0, 0 0)'), st_geogfromtext('LINESTRING(10 0, 10 1, 11 1, 11 0, 10 0)')) max_distance;

-- expected
SELECT(SELECT MAX_DISTANCE FROM ST_MAXDISTANCE(ST_GEOMFROMTEXT('LINESTRING(0 0,0 1,1 1,1 0,0 0)'),ST_GEOMFROMTEXT('LINESTRING(10 0,10 1,11 1,11 0,10 0)')))AS MAX_DISTANCE;

-- result
"max_distance"
"1228126.109277834"


-- provided
SELECT st_perimeter(st_geogfromtext('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))')) as perimeter;

-- expected
SELECT ST_PERIMETER_SPHEROID(ST_FLIPCOORDINATES(ST_GEOMFROMTEXT('POLYGON((0 0,0 1,1 1,1 0,0 0))')))AS PERIMETER;

-- result
"perimeter"
"443770.917248302"


-- provided
select ST_BUFFER(ST_GEOGFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'), 20) as buffer;

-- expected
SELECT ST_TRANSFORM(ST_BUFFER(ST_TRANSFORM(ST_GEOMFROMTEXT('POLYGON((0 0,0 1,1 1,1 0,0 0))')::GEOMETRY,'EPSG:4326','EPSG:6933'),20),'EPSG:6933','EPSG:4326')AS BUFFER;
-- result
"buffer"
"POLYGON ((0 -0.000207283356224, 0.999999998883127 -0.000207283356224, 1.00003058824032 -0.000203300464657, 1.000060002065931 -0.000191504850246, 1.000087110003095 -0.000172349811837, 1.000110870308919 -0.000146571466813, 1.000130369888099 -0.000115160462519, 1.00014485938266 -0.000079323906232, 1.000153781969387 -0.000040438976714, 1.00015679475823 0, 1.00015679475823 1, 1.000153781969387 1.000040438976714, 1.00014485938266 1.000079323906232, 1.000130369888099 1.000115160462518, 1.000110870308919 1.000146571466813, 1.000087110003095 1.000172349811836, 1.000060002065931 1.000191504850246, 1.00003058824032 1.000203300464657, 0.999999998883127 1.000207283356224, 0 1.000207283356224, -0.000030584822872 1.000203300464657, -0.000059994288153 1.000191504850246, -0.000087098206586 1.000172349811836, -0.000110854989785 1.000146571466813, -0.000130351677895 1.000115160462518, -0.000144839024125 1.000079323906232, -0.000153760287885 1.000040438976714, -0.000156772630011 1, -0.000156772630011 0, -0.000153760287885 -0.000040438976714, -0.000144839024125 -0.000079323906232, -0.000130351677895 -0.000115160462519, -0.000110854989785 -0.000146571466813, -0.000087098206586 -0.000172349811837, -0.000059994288153 -0.000191504850246, -0.000030584822872 -0.000203300464657, 0 -0.000207283356224))"


-- provided
select st_asbinary(ST_GEOGFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))')) as wkb;

-- expected
SELECT ST_ASWKB(ST_GEOMFROMTEXT('POLYGON((0 0,0 1,1 1,1 0,0 0))')::GEOMETRY) AS WKB;

-- result
"WKB"
"POLYGON ((0 0, 0 1, 1 1, 1 0, 0 0))"


-- provided
select ST_CLOSESTPOINT(ST_GEOGFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'), ST_GEOGFROMTEXT('POLYGON((2 2, 2 3, 3 3, 3 2, 2 2))')) as closest_point

-- expected
select ST_STARTPOINT(ST_ShortestLine(ST_GEOMFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'), ST_GEOMFROMTEXT('POLYGON((2 2, 2 3, 3 3, 3 2, 2 2))'))) as closest_point

-- result
"closest_point"
"POINT (1 1)"


-- provided
select 'in' AS label, st_dwithin(ST_GEOGFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'),ST_GEOGFROMTEXT('POLYGON((2 2, 2 3, 3 3, 3 2, 2 2))'), 157226) AS within_distance
UNION ALL
select 'out' AS label, st_dwithin(ST_GEOGFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'),ST_GEOGFROMTEXT('POLYGON((2 2, 2 3, 3 3, 3 2, 2 2))'), 157225) AS within_distance
;

-- expected
select 'in' AS label, st_dwithin(ST_GEOMFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'),ST_GEOMFROMTEXT('POLYGON((2 2, 2 3, 3 3, 3 2, 2 2))'), 157226) AS within_distance
UNION ALL
select 'out' AS label, st_dwithin(ST_GEOMFROMTEXT('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'),ST_GEOMFROMTEXT('POLYGON((2 2, 2 3, 3 3, 3 2, 2 2))'), 157225) AS within_distance
;

-- results
"label","within_distance"
"in","true"
"out","false"